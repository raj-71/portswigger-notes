# Write-up: Exploiting a mass assignment

Lab-Link: <https://portswigger.net/web-security/api-testing/lab-exploiting-mass-assignment-vulnerability>  
Difficulty: PRACTITIONER  
  

## Lab description

![lab_description](img/1.png)

### Goals

- Find mass assignment vulnerability
- Exploit this mass assignment vulnerability
- Buy this product `Lightweight l33t Leather Jacket` using this vulnerability

## Steps

Start Burp Proxy and make sure every request is going through burp proxy and is visible in http history. login into the website using given credentials `wiener:peter`. After login we can see that we have `$0.00` store credits.

![my_account](img/2.png)

When we visit `Lightweight l33t Leather Jacket` we find that it worth `$1337.00` and we add it to card, and when we try to buy this product we get error that we don't have enough store credits.

![product](img/3.png)

Now, to buy this product we have to either manipulate our store credits or the product cost or the third option is to bypass the order value checker while placing the order.

![cart](img/4.png)

When checking the http history in burp proxy we come across an interesting API `/api/checkout` which has a JSON response with some lucrative keywords like `chosen_discount` and `item price`, so we send it to repeater for futher analysis.

![http_history](img/5.png)

When we send `OPTIONS` request instead of `GET` we get to know that `POST` API is also available for the same.

![option_req](img/6.png)

When sending POST request, we get error `Unexpected }`, which hints towards that we have to add some JSON data with the request.

![post_req](img/7.png)

When we add an empty JSON, we get error that `chosen_products` is undefined.

![empty_json](img/8.png)

So, I just copied the JSON reponse of the `GET` request and changed the discount percentage to `100` so that we can buy the product with `$0.00` store credits. We get response and get redirected to order-confirmation.

![order_confirmation](img/9.png)

Hence, lab is solved.

![success](img/10.png)